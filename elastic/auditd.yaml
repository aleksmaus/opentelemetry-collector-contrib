# REMOVE before contributing!!!
# This is just a sample configuration for auditd POC
receivers:
  journald:
    # start_at: beginning
    priority: debug # default is info and is missing events that our auditd captures
    matches:
      - _TRANSPORT: audit

processors:
  resource:
    attributes:
      - key: data_stream.namespace
        value: default
        action: upsert
      - key: data_stream.type
        value: logs
        action: upsert
      - key: data_stream.dataset
        value: otel.auditd.log
        action: upsert
  auditd:
    resolve_ids: true
    preserve_original_event: true

  resourcedetection/system:
    detectors: ["system"]
    system:
      hostname_sources: ["os"]
      resource_attributes:
        host.arch:
          enabled: true
        host.name:
          enabled: true
        host.id:
          enabled: true
        host.ip:
          enabled: true
        host.mac:
          enabled: true
        host.cpu.vendor.id:
          enabled: true
        host.cpu.family:
          enabled: true
        host.cpu.model.id:
          enabled: true
        host.cpu.model.name:
          enabled: true
        host.cpu.stepping:
          enabled: true
        host.cpu.cache.l2.size:
          enabled: true
        os.description:
          enabled: true
        os.type:
          enabled: true

exporters:
  debug:
    verbosity: detailed
    # verbosity: normal
  elasticsearch:
    flush:
      interval: 1s
    endpoints:
      - https://d8796c0c914a480bb5c01fc4ac2e4a99.us-west2.gcp.elastic-cloud.com
    user: elastic
    password: RpoNZJnd0ZKcd9WOojeaxxxx
    logs_index: "logs-otel.auditd.log-default"
    mapping:
      mode: otel

service:
  pipelines:
    logs:
      receivers:
        - journald
      processors: ["resource", "auditd", "resourcedetection/system"]
      # processors: ["resource", "auditd"]
      exporters:
        - debug
        - elasticsearch
